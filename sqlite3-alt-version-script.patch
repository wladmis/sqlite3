diff --git a/Makefile.in b/Makefile.in
index 5576de8..dc39016 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -463,6 +472,7 @@ last_change:	$(SRC)
 
 libsqlite3.la:	$(LIBOBJ)
 	$(LTLINK) -o $@ $(LIBOBJ) $(TLIBS) \
+		-Wl,--version-script=libsqlite3.map -Wl,-z,defs \
 		${ALLOWRELEASE} -rpath "$(libdir)" -version-info "8:6:8"
 
 libtclsqlite3.la:	tclsqlite.lo libsqlite3.la
diff --git a/libsqlite3.map b/libsqlite3.map
new file mode 100644
index 0000000..6eba05c
--- /dev/null
+++ b/libsqlite3.map
@@ -0,0 +1,148 @@
+SQLITE_3.2.2 {
+    global:
+	sqlite3_db_handle;
+	sqlite3_get_autocommit;
+	sqlite3_transfer_bindings;
+    local:
+	[^sqlite3]*;
+};
+SQLITE_3.2.6 {
+    global:
+	sqlite3_profile;
+};
+SQLITE_3.3.0 {
+    global:
+	sqlite3_enable_shared_cache;
+	sqlite3_rollback_hook;
+	sqlite3_update_hook;
+};
+SQLITE_3.3.1 {
+    global:
+	sqlite3_thread_cleanup;
+};
+SQLITE_3.3.4 {
+    global:
+	sqlite3_value_numeric_type;
+};
+SQLITE_3.3.7 {
+    global:
+	sqlite3_bind_value;
+	sqlite3_clear_bindings;
+	sqlite3_column_value;
+	sqlite3_create_module;
+	sqlite3_declare_vtab;
+	sqlite3_enable_load_extension;
+	sqlite3_load_extension;
+	sqlite3_malloc;
+	sqlite3_realloc;
+	sqlite3_sleep;
+};
+SQLITE_3.3.8 {
+    global:
+	sqlite3_apis;
+	sqlite3_auto_extension;
+	sqlite3_extended_result_codes;
+	sqlite3_overload_function;
+	sqlite3_reset_auto_extension;
+};
+SQLITE_3.3.9 {
+    global:
+	sqlite3_prepare16_v2;
+	sqlite3_prepare_v2;
+};
+SQLITE_3.4.0 {
+    global:
+	sqlite3_bind_zeroblob;
+	sqlite3_blob_bytes;
+	sqlite3_blob_close;
+	sqlite3_blob_open;
+	sqlite3_blob_read;
+	sqlite3_blob_write;
+	sqlite3_create_collation_v2;
+	sqlite3_result_error_toobig;
+	sqlite3_result_zeroblob;
+};
+SQLITE_3.4.1 {
+	sqlite3_create_module_v2;
+};
+SQLITE_3.5.0 {
+    global:
+	sqlite3_file_control;
+	sqlite3_memory_alarm;
+	sqlite3_memory_highwater;
+	sqlite3_memory_used;
+	sqlite3_mutex_alloc;
+	sqlite3_mutex_enter;
+	sqlite3_mutex_free;
+	sqlite3_mutex_leave;
+	sqlite3_mutex_try;
+	sqlite3_open_v2;
+	sqlite3_release_memory;
+	sqlite3_result_error_nomem;
+	sqlite3_soft_heap_limit;
+	sqlite3_threadsafe;
+	sqlite3_vfs_find;
+	sqlite3_vfs_register;
+	sqlite3_vfs_unregister;
+};
+SQLITE_3.5.3 {
+    global:
+	sqlite3_sql;
+};
+SQLITE_3.5.5 {
+    global:
+	sqlite3_test_control;
+};
+SQLITE_3.5.6 {
+    global:
+	sqlite3_result_error_code;
+};
+SQLITE_3.5.8 {
+    global:
+	sqlite3_context_db_handle;
+	sqlite3_limit;
+	sqlite3_randomness;
+};
+SQLITE3_3.6.16 {
+    global:
+	sqlite3_backup_finish;
+	sqlite3_backup_init;
+	sqlite3_backup_pagecount;
+	sqlite3_backup_remaining;
+	sqlite3_backup_step;
+	sqlite3_config;
+	sqlite3_db_config;
+	sqlite3_db_mutex;
+	sqlite3_db_status;
+	sqlite3_extended_errcode;
+	sqlite3_initialize;
+	sqlite3_next_stmt;
+	sqlite3_os_end;
+	sqlite3_os_init;
+	sqlite3_shutdown;
+	sqlite3_status;
+	sqlite3_stmt_status;
+};
+
+SQLITE3_3.6.17 {
+    global:
+	sqlite3_strnicmp;
+};
+
+SQLITE3_3.6.18 {
+    global:
+	sqlite3_sourceid;
+};
+
+SQLITE3_COLUMN_METADATA {
+    global:
+	sqlite3_column_database_name;
+	sqlite3_column_database_name16;
+	sqlite3_column_origin_name;
+	sqlite3_column_origin_name16;
+	sqlite3_column_table_name;
+	sqlite3_column_table_name16;
+	sqlite3_table_column_metadata;
+};
+
+/* the prefix is SQLITE_, not SQLITE3_ */
